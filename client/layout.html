<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat</title>
    <!-- Favicon attr: http://www.iconarchive.com/show/3d-cartoon-vol3-icons-by-deleket/AOL-Instant-Messenger-icon.html -->
</head>
<body>
    <div class="page-container">
        {{> loginPanel}}
        <div class="chatroom">
            {{#if currentUser}}
            <div class="transcript">
                {{> chatBox}}
            </div>
             <div class="users">
                {{> allUsers}}
            </div>
            {{/if}}
        </div>
    </div>
</body>

<template name="loginPanel">
    <div class="login-panel btn {{loggedOut}}">
        {{#if currentUser}}
        &nbsp;<i class="icon-{{meteor_status}}" title="Connection Status"></i>
        {{/if}}
        {{loginButtons align="right"}}
    </div>
</template>

<template name="allUsers">
  <h3 class="section-heading">Folks:</h3>
  <ul class="users-list">
  {{#each users}}
    {{> userProfile}}
  {{/each}}
  </ul>
  <p class="alert alert-success alert-markdown">
    Messages auto-format <a href="http://daringfireball.net/projects/markdown/syntax">Markdown syntax</a>.
  </p>
</template>

<template name="chatBox">
    <form id="add-message-form" class="chatInputForm">
        <textarea class="chatInputBox" id="message-input" placeholder="You got something to say?" autofocus></textarea>
        <button class="chatInputAction btn btn-primary">Send</button>
    </form>
    <div class="messages-container">
        <ul class="messages">
            {{#each messages}}
                <li class="message {{user}} {{unreadStatus}} clearfix">
                    <strong class="messenger">{{messenger}}: </strong>
                    <div class="message-body">{{#markdown}}{{body}}{{/markdown}}</div>
                    <span class="message-timestamp">{{timestamp}}</span>
                </li>
            {{/each}}
        </ul>
    </div>
</template>

<template name="userProfile">
    <li class="user">
      <span class="email">{{email}}</span><span class="status">{{status}}</span>
    </li>
</template>